import re
import pandas as pd


def split_sheet_name(sheet_name):
    match = re.search(r"_v(\d+)\.csv$", sheet_name)
    if match:
        base_name = sheet_name[: match.start()] + ".csv"
        version = int(match.group(1))
    else:
        base_name = sheet_name
        version = 0
    return base_name, version


def load_table(sheet_name):
    sheet_id, version = split_sheet_name(sheet_name)
    sheet_data = get_sheet("{CLIENT_ID}", sheet_id, version)
    sheet = pd.DataFrame(sheet_data)
    if "Unnamed: 0" in sheet.columns:
        sheet = pd.DataFrame(sheet_data, index_col=0)
    return sheet

def save_table(sheet_data, sheet_name):
    sheet_data = sheet_data.fillna("").to_dict()
    upload_sheet_buffer("{CLIENT_ID}", sheet_name, sheet_data)

{PROGRAM}